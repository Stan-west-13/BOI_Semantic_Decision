---
title: "BOI_Regression"
author: "Stan West"
date: "2024-10-07"
output: pdf_document
---

```{r setup, include=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
library(purrr)

df <- readRDS("data/BOI-Assert-ADC_metadata.rds")
load("data/concrete_abstract.Rdata")
df_stim <- m_conc_abs %>%
  select(Word, level = level) %>%
  unique() %>%
  mutate(level = as.character(level))

df_stim$level[is.na(df_stim$level) ] <- "abstract"
df_stim$level <- as.factor(df_stim$level)



```


## Descriptives

```{r,echo=F}
df_descrip <- df %>%
  left_join(df_stim, by = c("word" = "Word")) %>%
  select(PROLIFIC_PID, correct, duration, group, n_correct,n_incorrect, level,adc_compscore) %>%
  group_by(PROLIFIC_PID, level) %>%
  reframe(PROLIFIC_PID = PROLIFIC_PID, 
            mean_duration = mean(duration),
            perc_correct = sum(correct == "true")/sum(correct == "true" | correct == "false"),
            group = group,
            adc_compscore = adc_compscore) %>%
  unique() %>%
  ungroup


```


## Table of means and boxplots

```{r}

df_descrip %>%
  group_by(group) %>%
  summarize(mean_dur = mean(mean_duration),
            mean_correct = mean(perc_correct))

ggplot(df_descrip, aes(x = group, y = mean_duration))+
  geom_boxplot()


ggplot(df_descrip, aes(x = group, y = perc_correct))+
  geom_boxplot()+
  facet_wrap(~level)
  

```


## T-tests of overall response latency and accuracy

```{r}
t.test(mean_duration ~ group, data = df_descrip)
t.test(perc_correct ~ group, data = df_descrip)

```


## Filter only correct responses

```{r cars}


  
ggplot(df_descrip, aes(x = adc_compscore, y = mean_duration, color = group))+
  geom_point() +
  facet_wrap(~level)+
  geom_smooth(method = "lm")


summary(lm(mean_duration ~ adc_compscore + group + level, data = df_descrip))

summary(lm(perc_correct ~ adc_compscore + group + level, data = df_descrip))


```



